<div>
    <app-header />
    <section
        class="bg-[url('/images/banner/shop.png')] h-[220px] mt-6 bg-cover bg-no-repeat relative bg-left"
    >
        <div class="absolute left-0 top-0 w-full h-full bg-[#2422228a]">
            <div
                class="w-[85%] md:w-[80%] sm:w-[90%] lg:w-[90%] h-full mx-auto"
            >
                <div
                    class="flex flex-col justify-center gap-1 items-center h-full w-full text-white"
                >
                    <h2 class="text-3xl font-bold">Shop Page</h2>
                    <div
                        class="flex justify-center items-center gap-2 text-2xl w-full"
                    >
                        <a routerLink="/">Home</a>
                        <span class="pt-1">
                            <fa-icon [icon]="faArrowRight"></fa-icon>
                        </span>
                        <span>Shop </span>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="py-16">
        <div class="w-[85%] md:w-[80%] sm:w-[90%] lg:w-[90%] h-full mx-auto">
            <div
                class="md:block hidden"
                [ngClass]="!$filter() ? 'mb-6' : 'mb-0'"
            >
                <button
                    class="text-center w-full py-2 px-3 bg-indigo-500 text-white"
                    (click)="$filter.set(!$filter())"
                >
                    Filter Product
                </button>
            </div>
            <div class="w-full flex flex-wrap">
                <div
                    class="w-3/12 md-lg:w-4/12 md:w-full pr-8"
                    [ngClass]="
                        $filter()
                            ? 'md:h-0 md:overflow-hidden md:mb-6'
                            : 'md:h-auto md:overflow-auto md:mb-0'
                    "
                >
                    <h2 class="text-3xl font-bold mb-3 text-slate-600">
                        Category
                    </h2>
                    <div class="py-2">
                        @for (category of $categories(); track category._id;) {
                        <div class="flex justify-start items-center gap-2 py-1">
                            <input
                                type="checkbox"
                                [id]="category.name"
                                [checked]="$category() === category.name"
                                (change)="queryCategory($event, category.name)"
                            />
                            <label
                                class="text-slate-600 block cursor-pointer"
                                [htmlFor]="category.name"
                                >{{ category.name }}</label
                            >
                        </div>
                        }
                    </div>
                    <div class="py-2 flex flex-col gap-5">
                        <h2 class="text-3xl font-bold mb-3 text-slate-600">
                            Price
                        </h2>
                        @if (low && high) {
                        <ngx-slider
                            [(value)]="low!"
                            [(highValue)]="high!"
                            [options]="sliderOptions"
                            (userChangeEnd)="onPriceChange()"
                        ></ngx-slider>
                        }
                        <div>
                            <span class="text-slate-800 font-bold text-lg">
                                {{
                                    $state().values[0]
                                        | appMathOperations : "simple"
                                        | currency
                                }}
                                -
                                {{
                                    $state().values[1]
                                        | appMathOperations : "simple"
                                        | currency
                                }}
                            </span>
                        </div>
                    </div>
                    <div class="py-3 flex flex-col gap-4">
                        <h2 class="text-3xl font-bold mb-3 text-slate-600">
                            Rating
                        </h2>
                        <div class="flex flex-col gap-3">
                            <ng-container *ngFor="let r of [5, 4, 3, 2, 1]">
                                <div
                                    class="text-orange-500 flex justify-start items-start gap-2 text-xl cursor-pointer"
                                >
                                    <fa-icon
                                        *ngFor="let star of [1, 2, 3, 4, 5]"
                                        [icon]="star <= r ? fasStar : farStar"
                                    ></fa-icon>
                                </div>
                            </ng-container>
                            <div
                                class="text-orange-500 flex justify-start items-start gap-2 text-xl cursor-pointer"
                                (click)="resetRating()"
                            >
                                <fa-icon
                                    *ngFor="let star of [1, 2, 3, 4, 5]"
                                    [icon]="farStar"
                                ></fa-icon>
                            </div>
                        </div>
                    </div>
                    <div class="py-5 flex flex-col gap-4 md:hidden">
                        <app-products
                            [title]="'Latest Product'"
                            [$products]="$latestProduct()"
                        />
                    </div>
                </div>
                <div class="w-9/12 md-lg:w-8/12 md:w-full">
                    <div class="pl-8 md:pl-0">
                        <div
                            class="py-4 bg-white mb-10 px-3 rounded-md flex justify-between items-start border"
                        >
                            <h2 class="text-lg font-medium text-slate-600">
                                ({{ $totalProduct() }} Products)
                            </h2>
                            <div class="flex justify-center items-center gap-3">
                                <select
                                    name=""
                                    id=""
                                    class="p-1 border outline-0 text-slate-600 font-semibold"
                                    (change)="selectChange($event)"
                                >
                                    <option value="">Sort By</option>
                                    <option value="low-to-high">
                                        Low to High Price
                                    </option>
                                    <option value="high-to-low">
                                        High to Low Price
                                    </option>
                                </select>
                                <div
                                    class="flex justify-center items-start gap-4 md-lg:hidden"
                                >
                                    <div
                                        class="p-2 text-slate-600 hover:bg-slate-300 cursor-pointer rounded-sm"
                                        [ngClass]="
                                            $styles() === 'grid'
                                                ? 'bg-slate-300'
                                                : null
                                        "
                                        (click)="$styles.set('grid')"
                                    >
                                        <fa-icon [icon]="faGrin"></fa-icon>
                                    </div>
                                    <div
                                        class="p-2 text-slate-600 hover:bg-slate-300 cursor-pointer rounded-sm"
                                        [ngClass]="
                                            $styles() === 'list'
                                                ? 'bg-slate-300'
                                                : null
                                        "
                                        (click)="$styles.set('list')"
                                    >
                                        <fa-icon [icon]="faList"></fa-icon>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="pb-8">
                            <app-shop-products
                                [styles]="$styles()"
                                [$products]="$products()"
                            />
                        </div>
                        <div>
                            @if ($totalProduct() > $parPage()) {
                            <app-pagination
                                [$pageNumber]="$pageNumber()"
                                [$totalItem]="$totalProduct()"
                                [$parPage]="$parPage()"
                                [$showItem]="
                                    $totalProduct()
                                        | appMathOperations
                                            : 'division'
                                            : $parPage()
                                "
                            />
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <app-footer />
</div>
